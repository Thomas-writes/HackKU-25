<!DOCTYPE html>
<html>
<head>
  <title>Spot-A-Song</title>
  <link rel="stylesheet" href="outstyles.css">
</head>
<body>

  <div id="topBar">
    <img src="../icon.png" alt="logo" id="logo">
    <h1 id="t">spot-a-song</h1>
  </div>

  <div id="button-container">
    <div class="square-box">
      <img class="square-box" src="" alt="playlist cover" id="playlist">
    </div>
    <button onclick="regen()" id="generation">generate again</button>
    <button>send to spotify</button>
  </div>
  <div id="song-section">
    <h1 id="song-list-title">
      songs:
    </h1>
    <ul class="song-list" id="main">
    </ul>
    <script>
      function regen() {
        window.close()
      }
      window.addEventListener('message', function(event) {
        console.log("Message received:", event.data);  // Log the received data
        const data = event.data;
        
        const { titleArray, artistArray, albumArray, spotifyURLArray, imageArray } = data;
        
        let playlist_cover = document.getElementById("playlist");
        let mainList = document.getElementById('main');
        
        function generate(aname, img, sname) {
          let songElement = document.createElement('li');
          let image = document.createElement('img');
          let info = document.createElement('div');
          let title = document.createElement('div');
          let artist = document.createElement('div');
    
          songElement.className = "song-item";
          image.className = "album-art"; image.src = img;
          info.className = "song-info";
          title.className = "song-title";
          artist.className = "artist-name";
          image.style.height = "100px";
          image.style.width = "100px";
          title.innerHTML = sname;
          artist.innerHTML = aname;
          title.style.color = "#143150";
          title.style.paddingLeft = "10px";
          title.style.fontSize = "20px";
          artist.style.color = "#C2EFB3";
          artist.style.paddingLeft = "15px";
          
          info.appendChild(title); 
          info.appendChild(artist);
          songElement.appendChild(image); 
          songElement.appendChild(info);
          mainList.appendChild(songElement);
        }
        
        playlist_cover.src = imageArray[0];
        // Generate list of songs
        for (let i = 0; i < titleArray.length; i++) {
          generate(artistArray[i], imageArray[i], titleArray[i]);
        }
      });
      let mainList = document.getElementById('main');
      mainList.innerHTML = ''; 
      for (let i = 0; i < titleArray.length; i++) {
        generate(artistArray[i], imageArray[i], titleArray[i]);
      }
    </script>
  </div>
</body>
</html>
